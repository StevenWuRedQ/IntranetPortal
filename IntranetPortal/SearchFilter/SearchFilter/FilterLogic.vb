Imports System.Text.RegularExpressions
Imports DuoVia.FuzzyStrings

Public Class FilterLogic
    Public Class LPinfo
        Public Property BBLE As String
        Public Property SoldUser As String
        Public Property LastLPDate As Date
        Public Property MrtageAmount As Double
        Public Property DeedDate As Date
        Public Sub New()

        End Sub
    End Class
    'Return true that mean the LP is not active.
    Public Shared Function LPSoldPortry(BBLE As String, Optional sLpInfo As LPinfo = Nothing) As Boolean
        Using ctx As New DataColectionEntities
            Dim LPS = ctx.LisPens.Where(Function(l) l.BBLE = BBLE).ToList()
            If LPS IsNot Nothing And LPS.Count > 0 Then
                'Get the most recently LP 
                Dim LastLP = LPS.OrderByDescending(Function(l) l.FileDate).FirstOrDefault()
                If (LastLP IsNot Nothing) Then
                    'Get real LP
                    Dim realLp = LPS.Where(Function(l) l.Docket_Number = LastLP.Docket_Number).OrderBy(Function(l) l.FileDate).FirstOrDefault()
                    If (sLpInfo IsNot Nothing) Then
                        sLpInfo.BBLE = BBLE
                        sLpInfo.LastLPDate = realLp.FileDate
                    End If
                    'Get List Of Acris Owner After real LP
                    Dim acrisAfterLp = ctx.Acris_Master_Owner_View.Where(Function(a) a.BBLE = BBLE AndAlso a.DOC__DATE >= realLp.FileDate).ToList()


                    'Get Acris LP user  Sold record 
                    Dim lpDeeDRecordList = acrisAfterLp.Where(Function(a) a.DOC__TYPE_DESCRIPTION.Contains("DEED") AndAlso a.PARTY_TYPE = 1 AndAlso a.DOC__AMOUNT > 150000).ToList

                    If (lpDeeDRecordList IsNot Nothing AndAlso lpDeeDRecordList.Any()) Then
                        'If LP user sold exit Check is value deed.
                        For Each lpDeeDRecord In lpDeeDRecordList

                            Dim deeDMorage = acrisAfterLp.Where(Function(a) a.DOC__TYPE_DESCRIPTION = "MORTGAGE" AndAlso a.DOC__DATE = lpDeeDRecord.DOC__DATE).FirstOrDefault


                            If (deeDMorage IsNot Nothing) Then

                                Dim isNotGood = deeDMorage.DOC__AMOUNT > 150000
                                If (isNotGood) Then
                                    If (sLpInfo IsNot Nothing) Then
                                        sLpInfo.DeedDate = lpDeeDRecord.DOC__DATE
                                        sLpInfo.MrtageAmount = CInt(deeDMorage.DOC__AMOUNT)
                                        sLpInfo.SoldUser = lpDeeDRecord.NAME
                                    End If
                                    Dim logString = lpDeeDRecord.NAME + " On " & lpDeeDRecord.DOC__DATE & " In Value Deed ! Morage is " & deeDMorage.DOC__AMOUNT & " After real Lp " & realLp.FileDate
                                    'Depend 3015680031 and 3016090015  check the LP user is useless so may be the condtion is after real LP there are a value DEED. that's not a good leads.
                                    If (SameName(lpDeeDRecord.NAME, realLp.Defendant)) Then
                                        LogBBLEFilter(BBLE, "Lead Sold by LP user " + logString, Nothing)

                                    Else
                                        LogBBLEFilter(BBLE, "Lead Sold by not Lp user " + logString, Nothing)
                                    End If

                                    Return isNotGood
                                End If
                                'Keep A log

                            End If
                        Next


                    End If
                End If
            End If

        End Using
        Return False
    End Function

    Private Shared Function LogBBLEFilter(BBLE As String, log As String, refiledDate As Date?) As Boolean
            Using ctx As New IntranetPortalEntities
                Dim soldCom = ctx.LeadsSoldAfterLPs.Where(Function(l) l.BBLE = BBLE).FirstOrDefault
                If (soldCom Is Nothing) Then
                    soldCom = New LeadsSoldAfterLP()
                    soldCom.BBLE = BBLE
                    ctx.LeadsSoldAfterLPs.Add(soldCom)
                    ctx.SaveChanges()
                    soldCom = ctx.LeadsSoldAfterLPs.Where(Function(l) l.BBLE = BBLE).FirstOrDefault
                End If
                soldCom.Comments = ""

                If (refiledDate IsNot Nothing) Then
                    soldCom.LPReFiled = True
                    soldCom.LastLPDate = refiledDate
                Else
                    soldCom.Comments = log
                End If


                soldCom.IsGood = False
                ctx.SaveChanges()
            End Using
            Return False
        End Function

        Public Shared Sub ClearAfterLps()
            Using ctx As New IntranetPortalEntities
                ctx.Database.ExecuteSqlCommand("delete FROM [LeadsSoldAfterLP]")
                ctx.SaveChanges()
            End Using
        End Sub

        Public Shared Function LpReFiled(BBLE As String) As Boolean
            Using ctx As New DataColectionEntities
                Dim lastLp = ctx.LisPens.Where(Function(l) l.BBLE = BBLE).OrderByDescending(Function(l) l.FileDate).FirstOrDefault()
                If (lastLp IsNot Nothing) Then
                    Dim isRefiled = lastLp.FileDate.AddYears(3) >= Date.Now
                    If (isRefiled) Then
                        LogBBLEFilter(BBLE, Nothing, lastLp.FileDate)
                    End If

                    Return isRefiled
                End If
            End Using
            Return False
        End Function
        Public Shared Function GetTestReslut(bbles As String()) As List(Of LeadsSoldAfterLP)
            Using ctx As New IntranetPortalEntities
                If (bbles Is Nothing) Then
                    Return ctx.LeadsSoldAfterLPs.ToList()
                End If
                Return ctx.LeadsSoldAfterLPs.Where(Function(l) bbles.Contains(l.BBLE)).ToList()
            End Using

        End Function

        Public Shared Function GetTestBBLEs() As String()
        Dim a() As String = {"2023601054", "2023601069", "2023601087", "2023601148", "2023601175", "2023601232", "2023601247", "2023601255", "2023601257", "2023690016", "2023700002", "2023770154", "2023880048", "2023890048", "2023940024", "2023990134", "2024000034", "2024020012", "2024260054", "2024280026", "2024280030", "2024310012", "2024320135", "2024360044", "2024360058", "2024360062", "2024360076", "2024360079", "2024360089", "2024370011", "2024370036", "2024390062", "2024390067", "2024390127", "2024470030", "2024470065", "2024500107", "2024500109", "2024520066", "2025050045", "2025060005", "2025060164", "2025080006", "2025090044", "2025120009", "2025120022", "2025120038", "2025120039", "2025161019", "2025170027", "2025190015", "2025190017", "2025210075", "2025210077", "2025230259", "2025240025", "2025260046", "2025280025", "2025280026", "2026080009", "2026140029", "2026170022", "2026170053", "2026170084", "2026220027", "2026240001", "2026300238", "2026301029", "2026330034", "2026330058", "2026371015", "2026371028", "2026460007", "2026510043", "2026520017", "2026520128", "2026610140", "2026610259", "2026620001", "2026620033", "2026620041", "2026630004", "2026660028", "2026671007", "2026671017", "2026680023", "2026690064", "2026710005", "2026730015", "2026730117", "2026740009", "2026750018", "2026750022", "2026750068", "2026760086", "2026771011", "2026771033", "2026771057", "2026771062", "2026771073", "2026771095", "2026771109", "2026771111", "2026771121", "2026771130", "2026861010", "2026870031", "2026880075", "2026900080", "2026920033", "2026920130", "2026930060", "2026931004", "2026931005", "2026931014", "2026931015", "2026931017", "2026940052", "2026940053", "2026940093", "2027000012", "2027000025", "2027000152", "2027010046", "2027040027", "2027050047", "2027050160", "2027060039", "2027070003", "2027070052", "2027080014", "2027080038", "2027080054", "2027080069", "2027150114", "2027190079", "2027200140", "2027210106", "2027260151", "2027450032", "2027480012", "2027480038", "2027480150", "2027481001", "2027481008", "2027491007", "2027491031", "2027491040", "2027520003", "2027520141", "2027530019", "2027570069", "2027610117", "2027650247", "2027660074", "2027680246", "2027820046", "2027820048", "2027820065", "2027820071", "2027820123", "2027820191", "2027830069", "2028390035", "2028460001", "2028640072", "2028650122", "2028650124", "2028650125", "2028720221", "2028720262", "2028720302", "2028870009", "2028870015", "2029330047", "2029350068", "2029360002", "2029360003", "2029360085", "2029370069", "2029610041", "2029610145", "2029620028", "2029630005", "2029630032", "2029630039", "2029630098", "2029630162", "2029640003", "2029650223", "2029650259", "2029680048", "2029680103", "2029700005", "2029700019", "2029700069", "2029710004", "2029710007", "2029710049", "2029720021", "2029720055", "2029740020", "2029740125", "2029760101", "2029860117", "2029870044", "2029870051", "2029940044", "2029940121", "2029990030", "2034290212", "2034290329", "2034290343", "2034300007", "2034300039", "2034300276", "2034321001", "2034321012", "2034321019", "2034321032", "2034321082", "2034321094", "2034321130", "2034321139", "2034321158", "2034321172", "2034321176", "2034321178", "2034321195", "2034321223", "2034321226", "2034321232", "2034321235", "2034321239", "2034321264", "2034321309", "2034321310", "2034321322", "2034321323", "2034321335", "2034321339", "2034321380", "2034321387", "2034321388", "2034321519", "2034321531", "2034321548", "2034321558", "2034321579", "2034321583", "2034321589", "2034321601", "2034321609", "2034321620", "2034321637", "2034321667", "2034321807", "2034321814", "2034321826", "2034321885", "2034321911", "2034321922", "2034321932", "2034321960", "2034410015", "2034410187", "2034420017", "2034420042", "2034420045", "2034430006", "2034430007", "2034430013", "2034430051", "2034430052", "2034450058", "2034450127", "2034450149", "2034460016", "2034460026", "2034460027", "2034460040", "2034460181", "2034470019", "2034470032", "2034470047", "2034470049", "2034470050", "2034470052", "2034480010", "2034480020", "2034480021", "2034480029", "2034530013", "2034530044", "2034530046", "2034530053", "2034530161", "2034540039", "2034550005", "2034550007", "2034550018", "2034550042", "2034550139", "2034560044", "2034560060", "2034560071", "2034560080", "2034570005", "2034570017", "2034570020", "2034570030", "2034570068", "2034570070", "2034570151", "2034570152", "2034580004", "2034580009", "2034580018", "2034580057", "2034580061", "2034580063", "2034580113", "2034590010", "2034590019", "2034590061", "2034600012", "2034600013", "2034600120", "2034600122", "2034610008", "2034610020", "2034690015", "2034690033", "2034690038", "2034700016", "2034700023", "2034700025", "2034700031", "2034700040", "2034700063", "2034710018", "2034710022", "2034710040", "2034710047", "2034710049", "2034710051", "2034720001", "2034720004", "2034720039", "2034720040", "2034730001", "2034730015", "2034730023", "2034730054", "2034740037", "2034740056", "2034750004", "2034750007", "2034750017", "2034750025", "2034750053", "2034750054", "2034750060", "2034750163", "2034760013", "2034760037", "2034760047", "2034770025", "2034780043", "2034780050", "2034830020", "2034830037", "2034830043", "2034830079", "2034830088", "2034830107", "2034860038", "2034860041", "2034860044", "2034860059", "2034860062", "2034920041", "2034920047", "2034920050", "2034920051", "2034920054", "2034920055", "2034920056", "2034920059", "2034930016", "2034930040", "2034930042", "2034930043", "2034930054", "2034930055", "2034930068", "2034930069", "2034930072", "2034940026", "2034940044", "2034940050", "2034940053", "2034940063", "2034940064", "2034940068", "2034950012", "2034950013", "2034950017", "2034950040", "2034950042", "2034950044", "2034960004", "2034960012", "2034960034", "2034960035", "2034960043", "2034960057", "2034960059", "2034960061", "2034970019", "2034970058", "2034980001", "2034980017", "2034980066", "2034990004", "2034990013", "2034990015", "2034990016", "2035000017", "2035000019", "2035000020", "2035000030", "2035000040", "2035000056", "2035000063", "2035000073", "2035070017", "2035070051", "2035070055", "2035070143", "2035070154", "2035080011", "2035080031", "2035080032", "2035080036", "2035080038", "2035080039", "2035080041", "2035080045", "2035080051", "2035080060", "2035080147", "2035090004", "2035090011", "2035090018", "2035090023", "2035090043", "2035090054", "2035090057", "2035090128", "2035090153", "2035100037", "2035100056", "2035100158", "2035100160", "2035110012", "2035110024", "2035110150", "2035120005", "2035120007", "2035120031", "2035120037", "2035120040", "2035120041", "2035120042", "2035120044", "2035120069", "2035120081", "2035120087", "2035120145", "2035120196", "2035200018", "2035200023", "2035200025", "2035200046", "2035200051", "2035200053", "2035200054", "2035200061", "2035210064", "2035210140", "2035220018", "2035220031", "2035220054", "2035220055", "2035220058", "2035220059", "2035220062", "2035220071", "2035230014", "2035230026", "2035240003", "2035250007", "2035250023", "2035250024", "2035250036", "2035250037", "2035250038", "2035250039", "2035250040", "2035250058", "2035250070", "2035260001", "2035260002", "2035260029", "2035260039", "2035260040", "2035260160", "2035270005", "2035270021", "2035270022", "2035270023", "2035270024", "2035270027", "2035270036", "2035270037", "2035270048", "2035270069", "2035280010", "2035280012", "2035310114", "2035310133", "2035310166", "2035310180", "2035310182", "2035310191", "2035310194", "2035310196", "2035320062", "2035330011", "2035330026", "2035330105", "2035330107", "2035330149", "2035330155", "2035550015", "2035550019", "2035550033", "2035550037", "2035550043", "2035550044", "2035550045", "2035550052", "2035550054", "2035550055", "2035550059", "2035560010", "2035560013", "2035560017", "2035560019", "2035560023", "2035560037", "2035560045", "2035560410", "2035570030", "2035570049", "2035570053", "2035570076", "2035570077", "2035580054", "2035590030", "2035590031", "2035600028", "2035600031", "2035600039", "2035600064", "2035600071", "2035600073", "2035600074", "2035610003", "2035610004", "2035610122", "2035610133", "2035610134", "2035610143", "2035610150", "2035620021", "2035750004", "2035750007", "2035750008", "2035750026", "2035750042", "2035940057", "2035950010", "2035950016", "2035950058", "2035960037", "2035960047", "2035970024", "2035970025", "2035970026", "2035970028", "2035970044", "2035970048", "2035970050", "2035980049", "2035980056", "2035980057", "2035990014", "2035990016", "2035990035", "2035990057", "2035990060", "2036070053", "2036080002", "2036080057", "2036080070", "2036090073", "2036100028", "2036110019", "2036110028", "2036110031", "2036110037", "2036120017", "2036120022", "2036120023", "2036120035", "2036130010", "2036130012", "2036130013", "2036130014", "2036130016", "2036130021", "2036130023", "2036130043", "2036130046", "2036130052", "2036140006", "2036140007", "2036140025", "2036140036", "2036140055", "2036150006", "2036170028", "2036431018", "2036431022", "2036431023", "2036431029", "2036431033", "2036431042", "2036431045", "2036431091", "2036431098", "2036431099", "2036431211", "2036431223", "2036431224", "2036500049", "2036510051", "2036510056", "2036511018", "2036590039", "2036590046", "2036590047", "2036600034", "2036600116", "2036670021", "2036670026", "2036670039", "2036780007", "2036780062", "2036780069", "2036790039", "2036790065", "2036790071", "2036800009", "2036800015", "2036800023", "2036800027", "2036800063", "2036840028", "2036840047", "2036850003", "2036850004", "2036850057", "2036860017", "2036860018", "2036860035", "2036860036", "2036860037", "2036870007", "2036870013", "2036870019", "2036870063", "2036880015", "2036880020", "2036880027", "2036880072", "2036900019", "2036900024", "2036900028", "2036910018", "2036910022", "2036910062", "2036920016", "2036920058", "2036930014", "2036930030", "2036940006", "2036940047", "2036940050", "2036940064", "2036940069", "2036960001", "2036960022", "2036960064", "2036970004", "2036970008", "2036980014", "2036980077", "2036990009", "2036990023", "2036990028", "2036990031", "2036990036", "2036990062", "2037520066", "2037630001", "2037810023", "2038020039", "2038020080", "2038740047", "2039442909", "2040510036", "2041310008", "2041741002", "2053550012", "2054140020", "2054140166", "2054140217", "2054140248", "2054150014", "2054171020", "2054171021", "2054171025", "2054171029", "2054171034", "2054171045", "2054171053", "2054171062", "2054270097", "2054450005", "2054861001", "2054861011", "2054861028", "2054881033", "2055190250", "2055291018", "2055291024", "2055291026", "2055291034", "2055770014", "2055820097", "2055890021", "2055900038", "2055971016", "2055981011", "2055981022", "2055981025", "2055981044", "2055981045", "2055981046", "2055981048", "2056041003", "2056041025", "2056041045", "2056061115", "2056061121", "2056061122", "2056061204", "2056070049", "2056250163", "2056250236", "2056260149", "2056270015", "2056270099", "2056320001", "2056350014", "2056350045", "2056360022", "2056360026", "2056360039", "2056360043", "2056390099", "2056411062", "2056411070", "2056411072", "2056411092", "2056420023", "2056421021", "2056421040", "2056430039", "2056430046", "2056431008", "2056431011", "2056440042", "2056450036", "2056451011", "2056451017", "2056470104", "2056480061", "2056480078", "2056480217", "3006330045", "3006370026", "3006370030", "3006461002", "3006461006", "3006480038", "3006480048", "3006480127", "3006510011", "3006520007", "3006570049", "3006580023", "3006600057", "3006730042", "3006730128", "3006731006", "3006731012", "3006850045", "3006850116", "3006920048", "3006970008", "3007180019", "3007180073", "3007190015", "3007220010", "3007220056", "3007280032", "3007320044", "3007320049", "3007330044", "3007360076", "3007380133", "3007390010", "3007400035", "3007410057", "3007420043", "3007420059", "3007420065", "3007460022", "3007470019", "3007470065", "3007480063", "3007490065", "3007560024", "3007600029", "3007600066", "3007660026", "3007670076", "3007720050", "3007760003", "3007770032", "3007780004", "3007810030", "3007810065", "3007810069", "3007820068", "3007830055", "3007850011", "3007890057", "3007890059", "3007900019", "3007900060", "3007910009", "3007910056", "3007940008", "3007940016", "3007970019", "3007970028", "3007970055", "3007980045", "3007980046", "3007980052", "3008000021", "3008000072", "3008050006", "3008050123", "3008060013", "3008060014", "3008060028", "3008060040", "3008070016", "3008130020", "3008130045", "3008130060", "3008130071", "3008130073", "3008140055", "3008150012", "3008150053", "3008170038", "3008170042", "3008210009", "3008210026", "3008210049", "3008210064", "3008210066", "3008230009", "3008230075", "3008240068", "3008250057", "3008260011", "3008290017", "3008290054", "3008340002", "3008360061", "3008370011", "3008370021", "3008370047", "3008370049", "3008370050", "3008370058", "3008380014", "3008380054", "3008420004", "3008460057", "3008460059", "3008470008", "3008540024", "3008540059", "3008630061", "3008650033", "3008951103", "3008951106", "3008951127", "3008951149", "3008951156", "3009130001", "3009130063", "3009140019", "3009150125", "3009151001", "3009151017", "3009170019", "3009180029", "3009191002", "3009251009", "3014800001", "3014850001", "3014990014", "3014990015", "3015030022", "3015170019", "3015850035", "3015850042", "3015890003", "3015890050", "3015890052", "3015890069", "3015910015", "3015910058", "3015940045", "3015990048", "3016030043", "3016031017", "3016070040", "3016100029", "3016120014", "3016120066", "3016150055", "3016150073", "3016150084", "3016190006", "3016230070", "3016240042", "3016240053", "3016250045", "3016250079", "3016251001", "3016260049", "3016260057", "3016260066", "3016290012", "3016300048", "3016310028", "3016370034", "3016380054", "3016400044", "3016400062", "3016420042", "3016420062", "3016420064", "3016470008", "3016470017", "3016470051", "3016480001", "3016480068", "3016480110", "3016520007", "3016520033", "3016530027", "3016530082", "3016540013", "3016550008", "3016550011", "3016560024", "3016570004", "3016570037", "3016570108", "3016580024", "3016580039", "3017320022", "3017470030", "3017470031", "3017470048", "3017540042", "3017540052", "3017551003", "3017551104", "3017560049", "3017560056", "3017580035", "3017580046", "3017600033", "3017610036", "3017660019", "3017660060", "3017660061", "3017660085", "3017670031", "3017670034", "3017670042", "3017670076", "3017670155", "3017680014", "3017680059", "3017680076", "3017690019", "3017700082", "3017700089", "3017700097", "3017710034", "3017720006", "3017720018", "3017720037", "3017720054", "3017720071", "3017740036", "3017750040", "3017760066", "3017810029", "3017810055", "3017810056", "3017811001", "3017811009", "3017811011", "3017811018", "3017811022", "3017820022", "3017820026", "3017820141", "3017860025", "3017860028", "3017860063", "3017910056", "3017910061", "3017920012", "3017920017", "3017920029", "3017950033", "3017950034", "3018000044", "3018000049", "3018000062", "3018010032", "3018010041", "3018050020", "3018050025", "3018050040", "3018050052", "3018050141", "3018100001", "3018100025", "3018100029", "3018100041", "3018100071", "3018110003", "3018110016", "3018150033", "3018150057", "3018150066", "3018150070", "3018150072", "3018150073", "3018150076", "3018160049", "3018160058", "3018160060", "3018160062", "3018160066", "3018160073", "3018200016", "3018250008", "3018250009", "3018250018", "3018250019", "3018250029", "3018250036", "3018250054", "3018250057", "3018250063", "3018250071", "3018260036", "3018300060", "3018310041", "3018360026", "3018360042", "3022310063", "3022311001", "3022311102", "3022311201", "3022320065", "3022321101", "3022321102", "3022341112", "3022341201", "3022341206", "3022351004", "3022370001", "3022370015", "3022371103", "3022371302", "3022371303", "3022371802", "3022372103", "3022381003", "3022381010", "3022381011", "3022381323", "3022401033", "3022401202", "3022401304", "3022401310", "3022401403", "3022401610", "3022401810", "3022401905", "3022402001", "3022402108", "3022402306", "3022411202", "3022411604", "3022411901", "3022412201", "3022412901", "3022413203", "3022413204", "3022413805", "3022413909", "3022413910", "3022414001", "3022414009", "3022421102", "3022441005", "3022441011", "3022441012", "3022441047", "3022441060", "3022441062", "3022441064", "3022441065", "3022441080", "3022441084", "3022451001", "3022481004", "3022511004", "3022511005", "3022511006", "3022511011", "3022511013", "3022511017", "3022511115", "3022511202", "3022511209", "3022511313", "3022621404", "3022621405", "3022621409", "3022631106", "3022631112", "3022631201", "3022631302", "3022641301", "3022641302", "3022641401", "3022641417", "3022641423", "3022641704", "3022641805", "3022642201", "3022642227", "3022642428", "3022642502", "3022642518", "3022642605", "3022642701", "3022642713", "3022660025", "3022671220", "3027860031", "3027880025", "3027880028", "3027890026", "3027900001", "3027900024", "3027920035", "3030090003", "3030150008", "3030231305", "3030401006", "3030420007", "3030430010", "3030440002", "3030441401", "3030510010", "3030510016", "3030510035", "3030730081", "3030761021", "3030761022", "3030761030", "3030761031", "3030790004", "3030790029", "3030880018", "3030880035", "3030890006", "3030970036", "3031330016", "3031330025", "3031340018", "3031340019", "3031340042", "3031350008", "3031370018", "3031500020", "3031500039", "3031570033", "3031600006", "3031600015", "3031600042", "3031640047", "3031650005", "3031660006", "3031660033", "3031700041", "3031710013", "3031710060", "3031730015", "3031730021", "3031730036", "3031740005", "3031750015", "3031750044", "3031750052", "3031760013", "3031760032", "3031830081", "3031860001", "3031860019", "3031860020", "3031860022", "3031870019", "3031880043", "3031890022", "3031930009", "3031930037", "3031940015", "3031940017", "3031940044", "3031960136", "3031970006", "3031970021", "3032040018", "3032040047", "3032060014", "3032060016", "3032070006", "3032110025", "3032110039", "3032140015", "3032140019", "3032140032", "3032140033", "3032160018", "3032170055", "3032180022", "3032180030", "3032180033", "3032180058", "3032190015", "3032200017", "3032250010", "3032260009", "3032260015", "3032260022", "3032260029", "3032270009", "3032270054", "3032270055", "3032270064", "3032290002", "3032290022", "3032300013", "3032300021", "3032320044", "3032320069", "3032340053", "3032360018", "3032380023", "3032390016", "3032410008", "3032410072", "3032430070", "3032450036", "3032460025", "3032470026", "3032470044", "3032480035", "3032490016", "3032490046", "3032500021", "3032520023", "3032520049", "3032540056", "3032540131", "3032550014", "3032550020", "3032560008", "3032560025", "3032560029", "3032570008", "3032570009", "3032570023", "3032580054", "3032590010", "3032590048", "3032630004", "3032630021", "3032630031", "3032630043", "3032630054", "3032640016", "3032640020", "3032650003", "3032650037", "3032650043", "3032650162", "3032660013", "3032680009", "3032680015", "3032680030", "3032680032", "3032690014", "3032690026", "3032700014", "3032700050", "3032730009", "3032730010", "3032730045", "3032750016", "3032750042", "3032750077", "3032750079", "3032750089", "3032750090", "3032790041", "3032790048", "3032790054", "3032790055", "3032830026", "3032840007", "3032840015", "3032840016", "3032850016", "3032850032", "3032850034", "3032850035", "3032850076", "3032860018", "3032870034", "3032890051", "3032890056", "3032900011", "3032920021", "3032930017", "3032940011", "3032940014", "3032940024", "3032940063", "3032960001", "3032960013", "3032960037", "3032960169", "3032970045", "3032970053", "3033000054", "3033010005", "3033010006", "3033010017", "3033010018", "3033010045", "3033010050", "3033020026", "3033050020", "3033050023", "3033050029", "3033050035", "3033050042", "3033050069", "3033060039", "3033070045", "3033070046", "3033070047", "3033080029", "3033090012", "3033100041", "3033110046", "3033140039", "3033140059", "3033140155", "3033170124", "3033190022", "3033190027", "3033190042", "3033200016", "3033200018", "3033210016", "3033210032", "3033210034", "3033230029", "3033260015", "3033260022", "3033260039", "3033260059", "3033280033", "3033350007", "3033350011", "3033370027", "3033400110", "3033480016", "3033480038", "3033490031", "3033520041", "3033520049", "3033520062", "3033520064", "3033530015", "3033570014", "3033570038", "3033590001", "3033590044", "3033590056", "3033590058", "3033610037", "3033610055", "3033610066", "3033630032", "3033660027", "3033660055", "3033670016", "3033670042", "3033670045", "3033680025", "3033680032", "3033680049", "3033730048", "3033750046", "3033760020", "3033760036", "3033770046", "3033770057", "3033780141", "3033800002", "3033800047", "3033810024", "3033810053", "3033820003", "3033820017", "3033820021", "3033820049", "3033830010", "3033830064", "3033840024", "3033850060", "3033880013", "3033880022", "3033880053", "3033890046", "3033890141", "3033920050", "3033920054", "3033920055", "3033930026", "3033930071", "3033940040", "3033940041", "3033950058", "3033960001", "3033960021", "3033960022", "3033960042", "3033970024", "3033970028", "3033980057", "3034010031", "3034010032", "3034010039", "3034010050", "3034010054", "3034020003", "3034020042", "3034020045", "3034020047", "3034020060", "3034020103", "3034030014", "3034030036", "3034030047", "3034030061", "3034040050", "3034070018", "3034080027", "3034080036", "3034080037", "3034080045", "3034080048", "3034090002", "3034090003", "3034090011", "3034090028", "3034090029", "3034090044", "3034090045", "3034090055", "3034100017", "3034100026", "3034100062", "3034110011", "3034110015", "3034110017", "3034110018", "3034110029", "3034110034", "3034110036", "3034120026", "3034120047", "3034120057", "3034140037", "3034140043", "3034140048", "3034140065", "3034140066", "3034150002", "3034150007", "3034150025", "3034150027", "3034150032", "3034150037", "3034170142", "3034180002", "3034180017", "3034180019", "3034180028", "3034180127", "3034190022", "3034200030", "3034210033", "3034210050", "3034220019", "3034230014", "3034230015", "3034230019", "3034230057", "3034230344", "3034230444", "3034240026", "3034240028", "3034240071", "3034250007", "3034250044", "3034250049", "3034260037", "3034260038", "3034280013", "3034280059", "3034280144", "3034290020", "3034290036", "3034290038", "3034290061", "3034300023", "3034300050", "3034300052", "3034310003", "3034310007", "3034320017", "3034320019", "3034320053", "3034330017", "3034330024", "3034330045", "3034330047", "3034330051", "3034330057", "3034330058", "3034340015", "3034340048", "3034340057", "3034340061", "3034340165", "3034350013", "3034350048", "3034360004", "3034360037", "3034360146", "3034370056", "3034380035", "3034380048", "3034380050", "3034390025", "3034390035", "3034390060", "3034400043", "3034400051", "3034410024", "3034410042", "3034410060", "3034450022", "3034460023", "3034460024", "3034500022", "3034500035", "3034500043", "3034500060", "3034510014", "3034510030", "3034510043", "3034510048", "3034560017", "3034560022", "3034560024", "3034560028", "3034560029", "3034560049", "3034570010", "3034570020", "3034570058", "3034570062", "3034620013", "3034620017", "3034660026", "3034660043", "3034660045", "3034660056", "3034690018", "3034710017", "3034710020", "3034720030", "3034730024", "3034830026", "3034860030", "3036630004", "3036630009", "3036630010", "3036630046", "3036630101", "3036650021", "3036710015", "3036710134", "3036720047", "3036730051", "3036740016", "3036860004", "3036860029", "3036870006", "3036880001", "3036880030", "3036880040", "3036980007", "3037050004", "3037070004", "3037070025", "3037080007", "3037080026", "3037080027", "3037170006", "3037200028", "3037210026", "3037220008", "3037240016", "3037250008", "3037490021", "3037500031", "3037530038", "3037530041", "3037530043", "3037570081", "3037650013", "3037650015", "3037720028", "3037731001", "3037740149", "3037760025", "3037820001", "3037900009", "3037920038", "3038060005", "3038071022", "3038190106", "3038190133", "3038340017", "3038350014", "3038360022", "3038370043", "3038380038", "3038380039", "3038380065", "3038400047", "3038410015", "3038420022", "3038430014", "3038660154", "3038730042", "3038730050", "3038840295", "3038840296", "3038850199", "3038860080", "3038880042", "3038900403", "3039050003", "3039100027", "3039100046", "3039100047", "3039110058", "3039120009", "3039120056", "3039130042", "3039130140", "3039190004", "3039220020", "3039240041", "3039250021", "3039250042", "3039250057", "3039260001", "3039260007", "3039260043", "3039270018", "3039270068", "3039280005", "3039280026", "3039290018", "3039290023", "3039290052", "3039300006", "3039300027", "3039300033", "3039320153", "3039340003", "3039340027", "3039410023", "3039460037", "3039500007", "3039500047", "3039510020", "3039570002", "3039570016", "3039580038", "3039580039", "3039600010", "3039600109", "3039630021", "3039680042", "3039710005", "3039710040", "3039730001", "3039730057", "3039730161", "3039760006", "3039760021", "3039760050", "3039760059", "3039760063", "3039760065", "3039770019", "3039780025", "3039780033", "3039800030", "3039800035", "3039810003", "3039820031", "3039830002", "3039830004", "3039830119", "3039840010", "3039870020", "3039880007", "3039890028", "3039910041", "3039950025", "3039990028", "3039990033", "3040010019", "3040020022", "3040020210", "3040030031", "3040030125", "3040040023", "3040060026", "3040070029", "3040080009", "3040080028", "3040080038", "3040090031", "3040100136", "3040110139", "3040150018", "3040180011", "3040180129", "3040240039", "3040240040", "3040250024", "3040300032", "3040320037", "3040320040", "3040330036", "3040330041", "3040360003", "3040400104", "3040410003", "3040410006", "3040410012", "3040420137", "3040470155", "3040500018", "3040500024", "3040500121", "3040500124", "3040510032", "3040520023", "3040520027", "3040530018", "3040530033", "3040530129", "3040540005", "3040540009", "3040540010", "3040540026", "3040550007", "3040550025", "3040560029", "3040560036", "3040570023", "3040610121", "3040630044", "3040650020", "3040650032", "3040660001", "3040700025", "3040700042", "3040710031", "3040760119", "3040760144", "3040770001", "3040770015", "3040770053", "3040780005", "3040780042", "3040800002", "3040800036", "3040800039", "3040810018", "3040810026", "3040830031", "3040870039", "3040871004", "3040880018", "3040880036", "3040890001", "3040890031", "3040890034", "3040920001", "3041010003", "3041030018", "3041050005", "3041050114", "3041060061", "3041060074", "3041080107", "3041080112", "3041080121", "3041090030", "3041090044", "3041090058", "3041090112", "3041110013", "3041130001", "3041130056", "3041140042", "3041140049", "3041150003", "3041150046", "3041160001", "3041180036", "3041190008", "3041190023", "3041190042", "3041190082", "3041200007", "3041210027", "3041210058", "3041210069", "3041210072", "3041210074", "3041210099", "3041230026", "3041230031", "3041240001", "3041240013", "3041240042", "3041240053", "3041250028", "3041260021", "3041260063", "3041260067", "3041270016", "3041270059", "3041280001", "3041290017", "3041290050", "3041290062", "3041300036", "3041310025", "3041310078", "3041320040", "3041320050", "3041330011", "3041330018", "3041340045", "3041340046", "3041350006", "3041350036", "3041350042", "3041350061", "3041350070", "3041360016", "3041370022", "3041370023", "3041370036", "3041400024", "3041410026", "3041450064", "3041460014", "3041470003", "3041470008", "3041470030", "3041480004", "3041480044", "3041480047", "3041480060", "3041480065", "3041490023", "3041500006", "3041500018", "3041500021", "3041500038", "3041500048", "3041510012", "3041510018", "3041510021", "3041510022", "3041510028", "3041520059", "3041530006", "3041530026", "3041530078", "3041530081", "3041540001", "3041540007", "3041540070", "3041560050", "3041570009", "3041620012", "3041620033", "3041620049", "3041630019", "3041640002", "3041640043", "3041650006", "3041650009", "3041650018", "3041650020", "3041680017", "3041680025", "3041700006", "3041700015", "3041700030", "3041700031", "3041700104", "3041720017", "3041720059", "3041720060", "3041720064", "3041720073", "3041730002", "3041730013", "3041730016", "3041740005", "3041740032", "3041740045", "3041780013", "3041830034", "3041840062", "3041890142", "3041910043", "3041930027", "3041930029", "3041950001", "3041950036", "3041980013", "3042010016", "3042020004", "3042030005", "3042050012", "3042090022", "3042090030", "3042100002", "3042100015", "3042100024", "3042110014", "3042150001", "3042150028", "3042150043", "3042270014", "3042280036", "3042290009", "3042290037", "3042300017", "3042310012", "3042310014", "3042310035", "3042320006", "3042330017", "3042340007", "3042340030", "3042360024", "3042370002", "3042370024", "3042450029", "3042450048", "3042460025", "3042460032", "3042460034", "3042470007", "3042470013", "3042490007", "3042490090", "3042510012", "3042510017", "3042520014", "3042520047", "3042550006", "3042550029", "3042620031", "3042620041", "3042660024", "3042660048", "3042670034", "3042680057", "3042690007", "3042700045", "3042740041", "3042740042", "3042750133", "3042820020", "3042820021", "3042820025", "3042820039", "3042830008", "3042830018", "3042830103", "3042830139", "3042850050", "3042850056", "3042850057", "3042850058", "3042890029", "3042910147", "3042980050", "3042980076", "3042990032", "3043000006", "3043000030", "3043000043", "3043010056", "3043030043", "3043040069", "3043040074", "3043050022", "3043080010", "3043120007", "3043120011", "3043130029", "3043130049", "3043160048", "3043160060", "3043160062", "3043180045", "3043210044", "3043220015", "3043320159", "3043320161", "3043420010", "3043590001", "3043820045", "3043820111", "3043830045", "3044000009", "3044030054", "3044141043", "3044151019", "3044151036", "3044151039", "3044151054", "3044151063", "3044151096", "3044151101", "3044151104", "3044151190", "3044151220", "3044151457", "3044151537", "3044200038", "3044210036", "3044231198", "3044231218", "3044231389", "3044231412", "3044231503", "3044231533", "3044231541", "3044530002", "3044530046", "3044540040", "3044550055", "3044550056", "3044560009", "3044560021", "3044560047", "3044560049", "3044560067", "3044560069", "3044560075", "3044570071", "3044580052", "3044580070", "3044640007", "3044650102", "3044650114", "3044730042", "3044760004", "3044780056", "3044790050", "3044800062", "3044810042", "3045000030", "3045030049", "3045040006", "3045050007", "3045050015", "3045060024", "3045060038", "3045180125", "3045180130", "3045190124", "3045190128", "3045190129", "3045190141", "3045270139", "3045280008", "3045290022", "3045290118", "3045310013", "3045460017", "3045460039", "3045460041", "3045460042", "3045470156", "3045480059", "3045480060", "3045490014", "3045650034", "3050700029", "3050710022", "3050720058", "3050920012", "3051140012", "3051150004", "3051160006", "3051410019", "3051410081", "3051410140", "3051420001", "3051420079", "3051420097", "3051440042", "3051530029", "3051540006", "3051540015", "3051540040", "3051540043", "3051540063", "3051750046", "3051750050", "3052561036", "3052581062", "3052581065", "3052591016", "3052600024", "3052600040", "3052610014", "3052610016", "3052640027", "3052640043", "3052650014", "3052660016", "3052680037", "3052700075", "3052710013", "3052710057", "3052720028", "3052730065", "3052740026", "3052770041", "3052771001", "3052780044", "3052800061", "3052820029", "3052830060", "3052860036", "3052871021", "3052871054", "3052900043", "3052900048", "3052901103", "3052911002", "3052920025", "3052930002", "3052930017", "3052930049", "3052930060", "3052930069", "3052930071", "3052940019", "3052940054", "3052950001", "3052960011", "3052960049", "3052960057", "3052960073", "3052970030", "3052970033", "3052990020", "3052990021", "3052990034", "3053020079", "3053030108", "3053040046", "3053040063", "3053041203", "3053041303", "3053050104", "3053060006", "3053060031", "3053060041", "3053060113", "3053080034", "3053090017", "3053100017", "3053110019", "3053110057", "3053110061", "3053110071", "3053130025", "3053140011", "3053140023", "3053140034", "3053170009", "3053180020", "3053200064", "3053200066", "3053200078", "3053200091", "3053220040", "3053220101", "3053220102", "3053220117", "3053220118", "3053220128", "3053221003", "3053221007", "3053260042", "3053281007", "3053281015", "3053290015", "3053290024", "3053290026", "3053290031", "3053300070", "3053310010", "3053320021", "3053320034", "3053320071", "3053320077", "3053340017", "3053340054", "3053350034", "3053350038", "3053360046", "3053360052", "3053370037", "3053370066", "3053380097", "3053390010", "3053390036", "3053390069", "3053400001", "3053400076", "3053420036", "3053440036", "3053450004", "3053450005", "3053450024", "3053460061", "3053470030", "3053471015", "3053471016", "3053471018", "3053471020", "3053480061", "3053480063", "3053480064", "3053490030", "3053490101", "3053500042", "3053510031", "3053510040", "3053520064", "3053520067", "3053520088", "3053530009", "3053530094", "3053540064", "3053550048", "3053550051", "3053550073", "3053550074", "3053550075", "3053550079", "3053560023", "3053560024", "3053560027", "3053560033", "3053560040", "3053560053", "3053560071", "3053570059", "3053570066", "3053570071", "3053570073", "3053580028", "3053590014", "3053590027", "3053590028", "3053590031", "3053590035", "3053590042", "3053590078", "3053590080", "3053600038", "3053610011", "3053610032", "3053630033", "3053630034", "3053640014", "3053640030", "3053650004", "3053650008", "3053650014", "3053650025", "3053660032", "3053660040", "3053660052", "3053660067", "3053661001", "3053661022", "3053671010", "3053680014", "3053680016", "3053690074", "3053700023", "3053700041", "3053700089", "3053720036", "3053720039", "3053720054", "3053721001", "3053730017", "3053730060", "3053730074", "3053740055", "3053740069", "3053740084", "3053740086", "3053750025", "3053770009", "3053770012", "3053770016", "3053770017", "3053770021", "3053770036", "3053770059", "3053780071", "3053780076", "3053810016", "3053810029", "3053821006", "3053830019", "3053850040", "3053850047", "3053860038", "3053870072", "3053870078", "3053870085", "3053870086", "3053880067", "3053890087", "3053900031", "3053901003", "3053910043", "3053940043", "3053940050", "3053940084", "3053950049", "3053960011", "3053960021", "3053960036", "3053960037", "3053960058", "3053961030", "3053970008", "3053970020", "3053970082", "3053970084", "3053980030", "3053980032", "3053990060", "3053990064", "3053990070", "3054000052", "3054000072", "3054010007", "3054010068", "3054020004", "3054060016", "3054070069", "3054071002", "3054080020", "3054080027", "3054110015", "3054160046", "3054171001", "3055850023", "3055850061", "3055850068", "3055880012", "3055880035", "3055880038", "3055880048", "3055880050", "3055880052", "3055880053", "3055890022", "3055890036", "3055890049", "3055890050", "3055890056", "3055890069", "3055890070", "3055920025", "3055920027", "3055920035", "3055920037", "3055921801", "3055921803", "3055921902", "3055922002", "3055922101", "3055922104", "3055922303", "3055922304", "3055930011", "3055930014", "3055940019", "3055940025", "3055940027", "3056070001", "3056440012", "3056510049", "3056510066", "3056580044", "3056650036", "3056860037", "3057000064", "3057070051", "3057820021", "3057820026", "3057840026", "3057890015", "3057930019", "3058000010", "3058090018", "3058170012", "3058181022", "3058290035", "3058390024", "3058410053", "3058480046", "3058480075", "3058490016", "3058500058", "3058520031", "3058520050", "3058540028", "3058550034", "3058551006", "3058560128", "3058560134", "3058600124", "3058620055", "3058670037", "3058690018", "3058700033", "3058730026", "3058740024", "3058740044", "3058750021", "3071580037", "4011770041", "4012420025", "4012430015", "4012430017", "4012430032", "4012440015", "4012440025", "4012440028", "4012440045", "4012460012", "4012460026", "4012460052", "4012480017", "4012480020", "4012580019", "4012580020", "4012580051", "4012590012", "4012590014", "4012590021", "4012600025", "4012610029", "4012620015", "4012620070", "4012620165", "4012631006", "4012631032", "4012631037", "4012661014", "4012661025", "4012681044", "4012701029", "4012701032", "4012701069", "4012701078", "4012701111", "4012701117", "4012701124", "4012701137", "4012701139", "4012701169", "4012701214", "4012710005", "4012710055", "4012720051", "4012820121", "4012820139", "4012820144", "4012860056", "4012880063", "4012890014", "4012890023", "4012890026", "4012890027", "4012890034", "4012890059", "4012890063", "4013020026", "4014310054", "4014320011", "4014320022", "4014330018", "4014331025", "4014331033", "4014331073", "4014350026", "4014360026", "4014360030", "4014360042", "4014370003", "4014370020", "4014370025", "4014370059", "4014440043", "4014440052", "4014440058", "4014470061", "4014480020", "4014500018", "4014520012", "4014520021", "4014520025", "4014520031", "4014520041", "4014520044", "4014520047", "4014520049", "4014521031", "4014521044", "4014530018", "4014530019", "4014570031", "4014600012", "4014620059", "4014621041", "4014621064", "4014621074", "4014621078", "4014621085", "4014630020", "4014630029", "4014630045", "4014630052", "4014640022", "4014650034", "4014650060", "4014650063", "4014660048", "4014660108", "4014670045", "4014670054", "4014670057", "4014670060", "4014670061", "4014690073", "4014760018", "4014760103", "4014770057", "4014780018", "4014780034", "4014790033", "4014790034", "4014800029", "4014800030", "4014800038", "4014800040", "4014800051", "4014810022", "4014810030", "4014810034", "4014810060", "4014820020", "4014820026", "4014820056", "4014820061", "4014820063", "4014820065", "4014820068", "4014820072", "4014820075", "4014830073", "4014830075", "4014840067", "4014840083", "4015930005", "4017100065", "4026400005", "4033611009", "4033650027", "4033710010", "4033810017", "4033820007", "4033920070", "4033950012", "4034010012", "4034040060", "4034060040", "4034400026", "4034410025", "4034550041", "4034690012", "4034700024", "4034780014", "4034840016", "4035030037", "4035190024", "4035210031", "4035400040", "4035470002", "4035470004", "4035510068", "4035540058", "4035541006", "4035541011", "4035600038", "4035690057", "4035700044", "4035710026", "4035780058", "4035790045", "4035870017", "4035890018", "4035950037", "4035960032", "4036000046", "4036100030", "4036100044", "4036230001", "4036280001", "4036330022", "4036371096", "4036460018", "4036590017", "4036810005", "4036820023", "4036820054", "4036860008", "4036860058", "4036860063", "4036900061", "4036990030", "4037061005", "4037061037", "4037061051", "4037061059", "4037150015", "4037300008", "4037310030", "4037310122", "4037320106", "4038090136", "4038100350", "4038260034", "4038430024", "4038450063", "4038700148", "4038830062"}
        Return a
            'Using ctx As New IntranetPortalEntities
            '    Return ctx.SearchResults.Select(Function(l) l.BBLE).Distinct().ToArray() 'ctx.PenddingAssign_DataLoop_View.Select(Function(l) l.BBLE).Distinct().ToArray()
            'End Using
        End Function

        Public Shared Function SameName(name1 As String, name2 As String) As Boolean
            Dim rgx = New Regex("[^A-Za-z]")
            Dim na = New String() {rgx.Replace(name1, "").ToUpper(), rgx.Replace(name2, "").ToUpper()}
            na = na.OrderBy(Function(n) n.Count()).ToArray()
            Dim diffent = na(1).FuzzyMatch(na(0))
            If (diffent > 0.4) Then
                Console.WriteLine(diffent)
            End If
            Return diffent > 0.5
        End Function
        Public Shared Sub Transfer2SearchReslut(results As List(Of SearchResult))
            Using ctx As New IntranetPortalEntities
                Dim i = ctx.SearchResults.ToList
                For Each v In results
                    ctx.SearchResults.Add(v)
                Next
                ctx.SaveChanges()
            End Using
        End Sub
    End Class
